var Sort=function(){var e={};return e.alphanumeric=function(e,t){return e==t?0:e<t?-1:1},e.default=e.alphanumeric,e.numeric_converter=function(e){return function(t){return"string"==typeof t&&(t=parseFloat(t.replace(/^[^\d\.]*([\d., ]+).*/g,"$1").replace(new RegExp("[^\\d"+e+"]","g"),"").replace(/,/,"."))||0),t||0}},e.numeric=function(t,n){return e.numeric.convert(t)-e.numeric.convert(n)},e.numeric.convert=e.numeric_converter("."),e.numeric_comma=function(t,n){return e.numeric_comma.convert(t)-e.numeric_comma.convert(n)},e.numeric_comma.convert=e.numeric_converter(","),e.ignorecase=function(t,n){return e.alphanumeric(e.ignorecase.convert(t),e.ignorecase.convert(n))},e.ignorecase.convert=function(e){return null==e?"":(""+e).toLowerCase()},e.currency=e.numeric,e.currency_comma=e.numeric_comma,e.date=function(t,n){return e.numeric(e.date.convert(t),e.date.convert(n))},e.date.fixYear=function(e){return e=+e,e<50?e+=2e3:e<100&&(e+=1900),e},e.date.formats=[{re:/(\d{2,4})-(\d{1,2})-(\d{1,2})/,f:function(t){return new Date(e.date.fixYear(t[1]),+t[2],+t[3]).getTime()}},{re:/(\d{1,2})[\/-](\d{1,2})[\/-](\d{2,4})/,f:function(t){return new Date(e.date.fixYear(t[3]),+t[1],+t[2]).getTime()}},{re:/(.*\d{4}.*\d+:\d+\d+.*)/,f:function(e){var t=new Date(e[1]);if(t)return t.getTime()}}],e.date.convert=function(t){for(var n,r,l=e.date.formats,a=0,o=l.length;a<o;a++)if((n=t.match(l[a].re))&&void 0!==(r=l[a].f(n)))return r;return 9999999999999},e}(),Table=function(){function e(e){return void 0!==e}function t(e,t){return new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)}function n(n,r){var l=n.className||"";e(l)&&!t(n,r)&&(n.className+=(l?" ":"")+r)}function r(e,t){var n=e.className||"";e.className=n.replace(new RegExp("(^|\\s)"+t+"(\\s|$)"),"$1")}function l(e,t){return e.className.match(new RegExp("(^|\\s)"+t+"([^ ]+)"))?RegExp.$2:null}function a(e){if(window.getComputedStyle){var t=window.getComputedStyle;return(a=function(e){return"none"==t(e,null).getPropertyValue("display")})(e)}return window.currentStyle?(a=function(e){return"none"==e.currentStyle.display})(e):(a=function(e){return"none"==e.style.display})(e)}function o(e,t,n){if(null!=e&&e.nodeName){if(e.nodeName==t||n&&e.nodeName==n)return e;for(;e=e.parentNode;)if(e.nodeName&&(e.nodeName==t||n&&e.nodeName==n))return e}return null}function i(t,n){for(var r=2;r<arguments.length;r++){var l=arguments[r];e(t[l])&&(n[l]=t[l])}}var s={AutoStripeClassName:"table-autostripe",StripeClassNamePrefix:"table-stripeclass:",AutoSortClassName:"table-autosort",AutoSortColumnPrefix:"table-autosort:",AutoSortTitle:"Click to sort",SortedAscendingClassName:"table-sorted-asc",SortedDescendingClassName:"table-sorted-desc",SortableClassName:"table-sortable",SortableColumnPrefix:"table-sortable:",NoSortClassName:"table-nosort",AutoFilterClassName:"table-autofilter",FilteredClassName:"table-filtered",FilterableClassName:"table-filterable",FilteredRowcountPrefix:"table-filtered-rowcount:",RowcountPrefix:"table-rowcount:",FilterAllLabel:"Filter: All",AutoPageSizePrefix:"table-autopage:",AutoPageJumpPrefix:"table-page:",PageNumberPrefix:"table-page-number:",PageCountPrefix:"table-page-count:"};return s.tabledata={},s.uniqueId=1,s.resolve=function(e,t){if(null!=e&&e.nodeName&&"TABLE"!=e.nodeName&&(e=o(e,"TABLE")),null==e)return null;if(!e.id){var n=null;do{var n="TABLE_"+s.uniqueId++}while(null!=document.getElementById(n));e.id=n}return this.tabledata[e.id]=this.tabledata[e.id]||{},t&&i(t,this.tabledata[e.id],"stripeclass","ignorehiddenrows","useinnertext","sorttype","col","desc","page","pagesize"),e},s.processTableCells=function(e,t,n,r){null!=(e=this.resolve(e))&&("TFOOT"!=t&&this.processCells(e.tHead,n,r),"THEAD"!=t&&this.processCells(e.tFoot,n,r))},s.processCells=function(e,t,n){if(null!=e&&e.rows&&e.rows.length&&e.rows.length>0)for(var r=e.rows,l=0,a=r.length;l<a;l++){var o=r[l];if(o.cells&&o.cells.length&&o.cells.length>0)for(var i=o.cells,s=0,u=i.length;s<u;s++){var c=i[s];t.call(this,c,n)}}},s.getCellIndex=function(e){var t=e.parentNode,n=t.cells;if(n&&n.length){n.length>1&&n[n.length-1].cellIndex>0&&(this.getCellIndex=function(e){return e.cellIndex})(e);for(var r=0,l=n.length;r<l;r++)if(t.cells[r]==e)return r}return 0},s.nodeValue={INPUT:function(t){return e(t.value)&&t.type&&("checkbox"!=t.type&&"radio"!=t.type||t.checked)?t.value:""},SELECT:function(e){return e.selectedIndex>=0&&e.options?e.options[e.selectedIndex].text:""},IMG:function(e){return e.name||""}},s.getCellValue=function(t,n){if(n&&e(t.innerText))return t.innerText;if(!t.childNodes)return"";for(var r=t.childNodes,l="",a=0,o=r.length;a<o;a++){var i=r[a],s=i.nodeType;if(1==s){var u=i.nodeName;this.nodeValue[u]?l+=this.nodeValue[u](i):l+=this.getCellValue(i)}else 3==s&&(e(i.innerText)?l+=i.innerText:e(i.nodeValue)&&(l+=i.nodeValue))}return l},s.tableHeaderIndexes={},s.getActualCellIndex=function(t){if(!e(t.cellIndex))return null;var n=o(t,"TABLE"),r=t.parentNode.rowIndex+"-"+this.getCellIndex(t);if(e(this.tableHeaderIndexes[n.id]))return this.tableHeaderIndexes[n.id][r];var l=[];this.tableHeaderIndexes[n.id]={};for(var a=o(t,"THEAD"),i=a.getElementsByTagName("TR"),s=0;s<i.length;s++)for(var u=i[s].cells,c=0;c<u.length;c++){var d,f=u[c],p=f.parentNode.rowIndex,g=p+"-"+this.getCellIndex(f),h=f.rowSpan||1,v=f.colSpan||1;e(l[p])||(l[p]=[]);for(var m=l[p],b=0;b<m.length+1;b++)if(!e(m[b])){d=b;break}this.tableHeaderIndexes[n.id][g]=d;for(var b=p;b<p+h;b++){e(l[b])||(l[b]=[]);for(var x=l[b],C=d;C<d+v;C++)x[C]="x"}}return this.tableHeaderIndexes[n.id][r]},s.sort=function(a,o){var i,u,c=null;"function"==typeof o&&(o={sorttype:o}),o=o||{},e(o.col)||(o.col=this.getActualCellIndex(a)||0),o.sorttype=o.sorttype||Sort.default,i=this.resolve(a,o),u=this.tabledata[i.id],e(u.lastcol)&&u.lastcol==u.col&&e(u.lastdesc)?u.desc=!u.lastdesc:u.desc=!!o.desc,u.lastcol=u.col,u.lastdesc=!!u.desc;var d=u.sorttype;"function"==typeof d.convert&&(c=u.sorttype.convert,d=Sort.alphanumeric),this.processTableCells(i,"THEAD",function(e){t(e,this.SortableClassName)&&(r(e,this.SortedAscendingClassName),r(e,this.SortedDescendingClassName),u.col==s.getActualCellIndex(e)&&l(e,s.SortableClassName)&&n(e,u.desc?this.SortedAscendingClassName:this.SortedDescendingClassName))});var f=i.tBodies;if(null!=f&&0!=f.length){for(var p=u.desc?function(e,t){return d(t[0],e[0])}:function(e,t){return d(e[0],t[0])},g=!!u.useinnertext,h=u.col,v=0,m=f.length;v<m;v++){var b=f[v],x=b.rows,C=[];if(!t(b,s.NoSortClassName)){var N,w=0;if(N=x[w])do{if(rowCells=N.cells){var T=h<rowCells.length?this.getCellValue(rowCells[h],g):null;c&&(T=c(T)),C[w]=[T,x[w]]}}while(N=x[++w]);C.sort(p),w=0;if(N=C[w])do{b.appendChild(N[1])}while(N=C[++w])}}u.pagesize?this.page(i):u.stripeclass&&this.stripe(i,u.stripeclass,!!u.ignorehiddenrows)}},s.filter=function(t,n,r){var l;r=r||{};var a=this.resolve(t,r),i=this.tabledata[a.id];if(n){"SELECT"==n.nodeName&&"select-one"==n.type&&n.selectedIndex>-1&&(n={filter:n.options[n.selectedIndex].value}),"INPUT"==n.nodeName&&"text"==n.type&&(n={filter:"/^"+n.value+"/"}),"object"!=typeof n||n.length||(n=[n]);for(var u=0,c=n.length;u<c;u++){var d=n[u];"string"==typeof d.filter&&(d.filter.match(/^\/(.*)\/$/)?(d.filter=new RegExp(RegExp.$1),d.filter.regex=!0):d.filter.match(/^function\s*\(([^\)]*)\)\s*\{(.*)}\s*$/)&&(d.filter=Function(RegExp.$1,RegExp.$2))),d&&!e(d.col)&&(l=o(t,"TD","TH"))&&(d.col=this.getCellIndex(l)),d&&d.filter||!i.filters?(i.filters=i.filters||{},i.filters[d.col]=d.filter):delete i.filters[d.col]}for(var f in i.filters)var p=!0;p||(i.filters=null)}else i.filters=null;return s.scrape(t)},s.page=function(t,n,r){return r=r||{},e(n)&&(r.page=n),s.scrape(t,r)},s.pageJump=function(e,t,n){return e=this.resolve(e,n),this.page(e,(s.tabledata[e.id].page||0)+t,n)},s.pageNext=function(e,t){return this.pageJump(e,1,t)},s.pagePrevious=function(e,t){return this.pageJump(e,-1,t)},s.scrape=function(l,a){var o,i,u,c,d,f,p,g,h,v,m=[],b=0,x=0;a=a||{},p=this.resolve(l,a),g=this.tabledata[p.id];var u=g.page;e(u)&&(u<0&&(g.page=u=0),c=g.pagesize||25,d=u*c+1,f=d+c-1);var C=p.tBodies;if(null!=C&&0!=C.length){for(var N=0,w=C.length;N<w;N++)for(var T=C[N],y=0,S=T.rows.length;y<S;y++){if(h=T.rows[y],v=!1,g.filters&&h.cells){var A=h.cells,E=A.length;for(o in g.filters)if(!v&&(i=g.filters[o])&&o<E){var I=this.getCellValue(A[o]);v=i.regex&&I.search?I.search(i)<0:"function"==typeof i?!i(I,A[o]):I!=i}}x++,v||(b++,e(u)&&(m.push(h),(b<d||b>f)&&(v=!0))),h.style.display=v?"none":""}if(e(u)&&d>=b){d=b-b%c,g.page=u=d/c;for(var N=d,w=m.length;N<w;N++)m[N].style.display=""}this.processTableCells(p,"THEAD",function(l){(g.filters&&e(g.filters[s.getCellIndex(l)])&&t(l,s.FilterableClassName)?n:r)(l,s.FilteredClassName)}),g.stripeclass&&this.stripe(p);var P=Math.floor(b/c)+1;return e(u)&&(g.container_number&&(g.container_number.innerHTML=u+1),g.container_count&&(g.container_count.innerHTML=P)),g.container_filtered_count&&(g.container_filtered_count.innerHTML=b),g.container_all_count&&(g.container_all_count.innerHTML=x),{data:g,unfilteredcount:b,total:x,pagecount:P,page:u,pagesize:c}}},s.stripe=function(e,t,l){l=l||{},l.stripeclass=t,e=this.resolve(e,l);var o=this.tabledata[e.id],i=e.tBodies;if(null!=i&&0!=i.length){t=o.stripeclass;for(var s=[r,n],u=0,c=i.length;u<c;u++){var d,f=i[u],p=f.rows,g=0,h=0;if(d=p[g])if(o.ignoreHiddenRows)do{s[h++%2](d,t)}while(d=p[++g]);else do{a(d)||s[h++%2](d,t)}while(d=p[++g])}}},s.getUniqueColValues=function(e,t){for(var n={},r=this.resolve(e).tBodies,l=0,a=r.length;l<a;l++)for(var o=r[l],i=0,s=o.rows.length;i<s;i++)n[this.getCellValue(o.rows[i].cells[t])]=!0;var u=[];for(var c in n)u.push(c);return u.sort()},s.auto=function(e){var n,r,a=document.getElementsByTagName("TABLE");if(null!=a)for(var o=0,i=a.length;o<i;o++){var u=s.resolve(a[o]);r=s.tabledata[u.id],(n=l(u,s.StripeClassNamePrefix))&&(r.stripeclass=n),t(u,s.AutoFilterClassName)&&s.autofilter(u),(n=l(u,s.AutoPageSizePrefix))&&s.autopage(u,{pagesize:+n}),((n=l(u,s.AutoSortColumnPrefix))||t(u,s.AutoSortClassName))&&s.autosort(u,{col:null==n?null:+n}),r.stripeclass&&t(u,s.AutoStripeClassName)&&s.stripe(u)}},s.autosort=function(e,t){e=this.resolve(e,t);var r=this.tabledata[e.id];this.processTableCells(e,"THEAD",function(e){var a=l(e,s.SortableColumnPrefix);null!=a&&(a=a||"default",e.title=e.title||s.AutoSortTitle,n(e,s.SortableClassName),e.onclick=Function("","Table.sort(this,{'sorttype':Sort['"+a+"']})"),null!=t.col&&t.col==s.getActualCellIndex(e)&&(r.sorttype=Sort['"+type+"']))}),null!=t.col&&s.sort(e,t)},s.autopage=function(e,t){e=this.resolve(e,t);var n=this.tabledata[e.id];if(n.pagesize)return this.processTableCells(e,"THEAD,TFOOT",function(e){var t=l(e,s.AutoPageJumpPrefix);"next"==t?t=1:"previous"==t&&(t=-1),null!=t&&(e.onclick=Function("","Table.pageJump(this,"+t+")"))}),(val=l(e,s.PageNumberPrefix))&&(n.container_number=document.getElementById(val)),(val=l(e,s.PageCountPrefix))&&(n.container_count=document.getElementById(val)),s.page(e,0,t)},s.cancelBubble=function(t){t=t||window.event,"function"==typeof t.stopPropagation&&t.stopPropagation(),e(t.cancelBubble)&&(t.cancelBubble=!0)},s.autofilter=function(e,n){n=n||{},e=this.resolve(e,n);var r,a=this.tabledata[e.id];s.processTableCells(e,"THEAD",function(r){if(t(r,s.FilterableClassName)){var l=s.getCellIndex(r),a=s.getUniqueColValues(e,l);if(a.length>0)if("function"==typeof n.insert)func.insert(r,a);else{for(var o='<select onchange="Table.filter(this,this)" onclick="Table.cancelBubble(event)" class="'+s.AutoFilterClassName+'"><option value="">'+s.FilterAllLabel+"</option>",i=0;i<a.length;i++)o+='<option value="'+a[i]+'">'+a[i]+"</option>";o+="</select>",r.innerHTML+="<br>"+o}}}),(r=l(e,s.FilteredRowcountPrefix))&&(a.container_filtered_count=document.getElementById(r)),(r=l(e,s.RowcountPrefix))&&(a.container_all_count=document.getElementById(r))},"undefined"!=typeof jQuery?jQuery(s.auto):window.addEventListener?window.addEventListener("load",s.auto,!1):window.attachEvent&&window.attachEvent("onload",s.auto),s}();
